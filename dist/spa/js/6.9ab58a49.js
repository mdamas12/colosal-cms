(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6],{"39b2":function(e,t,r){"use strict"},"4f5a":function(e,t,r){"use strict"},"560a":function(e,t,r){"use strict";(function(e){var s=r("e9b9"),o=r("bc3a"),a=r.n(o);const i=e.env.API_URL+"panel/";class c{getProducts(e,t){return s["a"].create(r=>{a.a.get(i+`products/?limit=${e}&offset=${t}`).then(e=>{r.next(e.data),r.complete()}).catch(e=>{r.error(e)})})}getAllProducts(){return s["a"].create(e=>{a.a.get(i+"products/").then(t=>{console.log(t.data),e.next(t.data),e.complete()}).catch(t=>{e.error(t)})})}searchProducts(e){return s["a"].create(t=>{a.a.get(i+`products/coincidence/${e}/`).then(e=>{t.next(e.data),t.complete()}).catch(e=>{t.error(e)})})}createProduct(e,t,r){return s["a"].create(s=>{a()({method:"post",url:i+"products/",data:e,headers:{"Content-Type":"multipart/form-data"}}).then(e=>{let o=e.data.id;0===Object.keys(t).length&&(s.next(e.data),s.complete()),a()({method:"post",url:i+"products/features/",data:{features:t,product:e.data.id}}).then(e=>{0===Object.keys(r).length&&(s.next(e.data),s.complete()),r.append("product",o),a()({method:"post",url:i+"products/gallery/",data:r,headers:{"Content-Type":"multipart/form-data"}}).then(e=>{s.next(e.data),s.complete()}).catch(e=>{console.log(e),s.error(e)})}).catch(e=>{console.log(e)})}).catch(e=>{console.log(e)})})}getProduct(e){return s["a"].create(t=>{console.log("id: "+e),a.a.get(i+`products/search/${e}/`).then(e=>{t.next(e.data),t.complete()}).catch(e=>{t.error(e)})})}updateProduct(e,t){return s["a"].create(r=>{a.a.put(i+`products/search/${t}/`,e).then(e=>{console.log(),r.next(e.data),r.complete()}).catch(e=>{r.error(e)})})}deleteProduct(e){return s["a"].create(t=>{a.a.delete(i+`products/search/${e}/`).then(e=>{console.log("Siiiiii"),t.next(e.data),t.complete()}).catch(e=>{console.log(e.response.data),t.error(e)})})}getDetailProduct(e){return s["a"].create(t=>{a.a.get(i+`products/product-detail/${e}/`).then(e=>{console.log(),t.next(e.data),t.complete()}).catch(e=>{t.error(e)})})}deleteDetailProduct(e){return s["a"].create(t=>{a.a.delete(i+`products/product-detail/${e}/`).then(e=>{console.log(),t.next(e.data),t.complete()}).catch(e=>{t.error(e)})})}}t["a"]=new c}).call(this,r("4362"))},"6c5b":function(e,t,r){"use strict";(function(e){var s=r("e9b9"),o=r("bc3a"),a=r.n(o);r("39b2");const i=e.env.API_URL+"panel/";class c{getSupplyOrders(e,t){return s["a"].create(r=>{a.a.get(i+`purchases/list?limit=${e}&offset=${t}`).then(e=>{r.next(e.data),r.complete()}).catch(e=>{r.error(e)})})}createSupplyOrder(e){return s["a"].create(t=>{a.a.post(i+"purchases/",{purchase:e.purchase,products:e.detail}).then(e=>{console.log(e),t.complete()}).catch(e=>{t.error(e)})})}getSupplyOrder(e){return s["a"].create(t=>{console.log("id: "+e),a.a.get(i+`purchases/detail/${e}/`).then(e=>{t.next(e.data),t.complete()}).catch(e=>{t.error(e)})})}updateSupplyOrder(e,t){return s["a"].create(r=>{a.a.put(i+`purchases/detail/${t}/`,{purchase:e.purchase,products:e.products}).then(e=>{console.log(),r.complete()}).catch(e=>{r.error(e)})})}deleteSupplyOrder(e){return s["a"].create(t=>{a.a.delete(i+`purchases/${e}/`).then(e=>{console.log(),t.complete()}).catch(e=>{t.error(e)})})}}t["a"]=new c}).call(this,r("4362"))},"89b8":function(e,t,r){"use strict";(function(e){var s=r("e9b9"),o=r("bc3a"),a=r.n(o);r("4f5a");const i=e.env.API_URL+"panel/";class c{getSuppliers(e,t){return s["a"].create(r=>{a.a.get(i+`providers/?limit=${e}&offset=${t}`).then(e=>{r.next(e.data),r.complete()}).catch(e=>{r.error(e)})})}createSupplier(e){return s["a"].create(t=>{a.a.post(i+"providers/",{name:e.name,address:e.address,email:e.email,number:e.number,agent:e.agent}).then(e=>{console.log(e),t.next(e.data),t.complete()}).catch(e=>{t.error(e)})})}getSupplier(e){return s["a"].create(t=>{console.log("id: "+e),a.a.get(i+`providers/${e}/`).then(e=>{t.next(e.data),t.complete()}).catch(e=>{t.error(e)})})}searchSuppliers(e){return s["a"].create(t=>{a.a.get(i+`providers/search/${e}/`).then(e=>{t.next(e.data),t.complete()}).catch(e=>{t.error(e)})})}updateSupplier(e){return s["a"].create(t=>{a.a.put(i+`providers/${e.id}/`,{name:e.name,address:e.address,email:e.email,number:e.number,agent:e.agent}).then(e=>{console.log(),t.next(e.data),t.complete()}).catch(e=>{t.error(e)})})}deleteSupplier(e){return s["a"].create(t=>{a.a.delete(i+`providers/${e}/`).then(e=>{console.log(e),t.next(e.data),t.complete()}).catch(e=>{t.error(e)})})}}t["a"]=new c}).call(this,r("4362"))},a42a:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-page",[r("div",{staticClass:"col-md-12 col-xs-12 q-pa-sm"},[r("div",{staticClass:"q-pa-sm"},[r("div",{staticClass:"row"},[r("div",{staticClass:"col",staticStyle:{"max-width":"40px"}},[r("q-btn",{staticStyle:{color:"#9E9E9E"},attrs:{flat:"",round:"",icon:"keyboard_backspace"},on:{click:function(t){return e.$router.back()}}})],1),r("div",{staticClass:"col2"},[r("h5",{staticClass:"vertical-top col2 text-indigo-10 text-weight-bolder q-pa-sm",staticStyle:{"margin-top":"-3px"}},[e._v("\n                    Editar Compra a Proveedor\n                ")])]),r("div",{staticClass:"col"},[r("q-btn",{staticClass:"q-pa-xs q-mr-xs float-right",attrs:{flat:"",color:"red-10",label:"Eliminar",loading:e.loading2},on:{click:function(t){return e.confirmDelete()}}})],1),r("div",{staticClass:"col",staticStyle:{"max-width":"110px"}},[r("q-btn",{staticClass:"q-pa-xs q-mr-md float-right",attrs:{color:"red-10",label:"Guardar",loading:e.loading1},on:{click:function(t){return e.updateSupplyOrder()}}})],1)]),r("div",{staticClass:"q-pa-lg"},[r("div",{staticClass:"row q-mb-md"},[r("div",{staticClass:"col q-mr-md"},[r("q-input",{attrs:{outlined:"",label:"Referencia",color:"dark","lazy-rules":"",rules:[function(e){return!!e||"Debe ingresar el No. de referencia"}]},model:{value:e.order.purchase.invoice,callback:function(t){e.$set(e.order.purchase,"invoice",t)},expression:"order.purchase.invoice"}})],1),r("div",{staticClass:"col"},[r("q-input",{attrs:{outlined:"",type:"date",color:"dark",hint:"Fecha de Compra","lazy-rules":"",rules:[function(e){return!!e||"Debe ingresar la fecha de compra"}]},model:{value:e.order.purchase.date,callback:function(t){e.$set(e.order.purchase,"date",t)},expression:"order.purchase.date"}},[r("q-tooltip",{attrs:{"content-class":"bg-grey-8",anchor:"top left",self:"bottom left",offset:[0,8]}},[e._v("Fecha de compra")])],1)],1)]),r("div",{staticClass:"row q-mb-lg"},[r("div",{staticClass:"col q-mr-md"},[r("q-input",{attrs:{outlined:"",autogrow:"",color:"dark",label:"Descripción"},model:{value:e.order.purchase.description,callback:function(t){e.$set(e.order.purchase,"description",t)},expression:"order.purchase.description"}})],1),r("div",{staticClass:"col"},[r("q-select",{attrs:{outlined:"","use-input":"","hide-selected":"","fill-input":"",color:"dark","input-debounce":"0",label:"Proveedor",loading:e.searchingSupplier,hint:e.supplierHint,options:e.options,rules:[function(e){return!!e||"Debe ingresar algún proveedor"}]},on:{filter:e.filterFn,input:function(t){return e.setSupplier()}},scopedSlots:e._u([{key:"no-option",fn:function(){return[r("q-item",[r("q-item-section",{staticClass:"text-grey"},[e._v("\n                        No results\n                      ")])],1)]},proxy:!0}]),model:{value:e.supplierNameModel,callback:function(t){e.supplierNameModel=t},expression:"supplierNameModel"}})],1)]),r("div",{staticClass:"row"},[r("div",{staticClass:"col q-mr-md"},[r("q-select",{attrs:{outlined:"",options:e.currencyOptions,label:"Moneda",rules:[function(e){return!!e||"Debe seleccionar alguna moneda"}]},model:{value:e.order.purchase.coin,callback:function(t){e.$set(e.order.purchase,"coin",t)},expression:"order.purchase.coin"}})],1),r("div",{staticClass:"col"},[r("q-input",{attrs:{outlined:"",color:"dark",label:"Costo total",mask:"#.##","fill-mask":"0",prefix:e.order.purchase.coin,"reverse-fill-mask":"",hint:"Mask: #.##","input-class":"text-right",rules:[function(e){return!!e||"Debe ingresar el monto total"},e.isGreaterThanZero]},model:{value:e.order.purchase.amount,callback:function(t){e.$set(e.order.purchase,"amount",t)},expression:"order.purchase.amount"}})],1)]),r("br"),r("q-separator",{attrs:{inset:""}}),r("h5",{staticClass:"vertical-top col2 text-indigo-10 text-weight-bolder q-pa-sm q-mt-md",staticStyle:{"margin-top":"-3px"}},[e._v("\n                Detalle de Productos\n            ")]),r("div",{staticClass:"q-gutter-md"},e._l(this.order.products,(function(t,s){return r("div",[r("div",{staticClass:"row justify-evenly items-center"},[r("div",{staticClass:"col-10"},[r("div",{staticClass:"row q-mb-md"},[r("div",{staticClass:"col"},[r("q-select",{attrs:{outlined:"",color:"dark","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",label:"Producto",options:e.options2,rules:[function(e){return!!e||"Debe seleccionar algún producto"}]},on:{filter:e.filterFn2,input:function(t){return e.getProductInfo(e.productNameModel[s],s)}},scopedSlots:e._u([{key:"no-option",fn:function(){return[r("q-item",[r("q-item-section",{staticClass:"text-grey"},[e._v("\n                                No results\n                              ")])],1)]},proxy:!0}],null,!0),model:{value:e.productNameModel[s],callback:function(t){e.$set(e.productNameModel,s,t)},expression:"productNameModel[index]"}})],1),r("div",{staticClass:"col q-mx-sm"},[r("q-input",{attrs:{label:"Precio",mask:"#.##",color:"dark","fill-mask":"0","reverse-fill-mask":"","input-class":"text-right",outlined:"",rules:[function(e){return!!e||"Ingresar el costo del producto"},e.isGreaterThanZero]},model:{value:e.order.products[s].purchase_price,callback:function(t){e.$set(e.order.products[s],"purchase_price",e._n(t))},expression:"order.products[index].purchase_price"}})],1),r("div",{staticClass:"col"},[r("q-input",{attrs:{color:"dark",type:"number",label:"Cantidad",outlined:"",rules:[function(e){return!!e||"Ingresar la cantidad comprada"},e.isGreaterThanZero]},model:{value:e.order.products[s].purchase_quantity,callback:function(t){e.$set(e.order.products[s],"purchase_quantity",e._n(t))},expression:"order.products[index].purchase_quantity"}})],1)]),r("div",{staticClass:"row"},[r("div",{staticClass:"col q-mr-md"},[r("q-input",{attrs:{color:"dark",type:"number",label:"Unidades Recibidas",outlined:""},model:{value:e.order.products[s].purchase_Received,callback:function(t){e.$set(e.order.products[s],"purchase_Received",e._n(t))},expression:"order.products[index].purchase_Received"}})],1),r("div",{staticClass:"col"},[r("q-select",{attrs:{outlined:"",color:"dark",options:e.statusOptions,label:"Estatus",rules:[function(e){return!!e||"Ingresar el costo del producto"}]},model:{value:e.order.products[s].status,callback:function(t){e.$set(e.order.products[s],"status",t)},expression:"order.products[index].status"}})],1)])]),r("div",{staticClass:"col-1 self-center"},[r("div",{staticClass:"column items-center"},[r("q-btn",{attrs:{flat:"",round:"",color:"red-10",icon:"delete"},on:{click:function(t){return e.removeProduct(s)}}})],1)])]),r("div",{staticClass:"row q-my-lg"},[r("q-separator",{attrs:{inset:""}})],1)])})),0),r("br"),r("q-btn",{attrs:{flat:"",round:"",color:"indigo-10",icon:"add"},on:{click:function(t){return e.addProduct()}}})],1)])])])},o=[],a=(r("e01a"),r("c975"),r("a434"),r("2ef0")),i=r.n(a),c=r("2b0e"),n=r("6c5b"),l=r("89b8"),d=r("560a"),u=r("f508"),p=c["default"].extend({data(){return{loading1:!1,loading2:!1,id:this.$router.currentRoute.params.id,order:{purchase:{date:"",description:"",invoice:"",coin:"",amount:"",provider:0},products:[{product:0,purchase_price:0,purchase_quantity:0,purchase_Received:0,status:""}]},supplyOrderId:this.$router.currentRoute.params.id,supplierHint:"",supplierQuery:"",searchingSupplier:!1,loading:!1,supplierOptions:[],supplierIndex:[],options:[],productOptions:[],productIndex:[],productPrices:[],options2:[],currencyOptions:["USD","BS"],statusOptions:["COMPLETE"],supplierNameModel:"",productNameModel:[]}},mounted(){const e=this;e.onRequest()},methods:{onRequest(){u["a"].show(),this.order.products.pop(),n["a"].getSupplyOrder(this.supplyOrderId).subscribe({next:e=>{console.log(e),this.order.purchase.date=e.date,this.order.purchase.description=e.description,this.order.purchase.invoice=e.invoice,this.order.purchase.coin=e.coin,this.order.purchase.amount=e.amount,this.order.purchase.provider=e.provider.id,this.supplierNameModel=e.provider.name;for(let t=0;t<e.PurchaseDetail.length;t++)this.order.products.push({product:e.PurchaseDetail[t].product.id,purchase_price:e.PurchaseDetail[t].purchase_price,purchase_quantity:e.PurchaseDetail[t].purchase_quantity,purchase_Received:e.PurchaseDetail[t].purchase_Received,status:e.PurchaseDetail[t].status}),console.log("Producto: "+this.productOptions[this.productIndex.indexOf(e.PurchaseDetail[t].product.id)]),this.productNameModel.push(this.productOptions[this.productIndex.indexOf(e.PurchaseDetail[t].product.name)])},complete:()=>{u["a"].hide()}})},addProduct(){this.order.products.push({product:0,purchase_price:0,purchase_quantity:0,purchase_Received:0,status:""}),this.productNameModel.push("")},getProductInfo(e,t){console.log("user input: "+e+"\nposition: "+this.productOptions.indexOf(e)),this.productOptions.indexOf(e)>=0&&(this.order.products[t].product=this.productIndex[this.productOptions.indexOf(e)],this.order.products[t].purchase_price=parseFloat(this.productPrices[this.productOptions.indexOf(e)])),console.log(this.order.products)},removeProduct(e){this.order.products.length>0&&(this.order.products.splice(e,1),this.productNameModel.splice(e,1))},checkSupplyOrder(){if(""!==this.supplierNameModel)if(""!==this.order.purchase.date)if(""!=this.order.puchase.invoice)if(""!==this.order.purchase.coin)if(""!==this.order.purchase.amount){for(var e=0;e<this.order.products.length;e++){if(""===this.productNameModel[e])return void this.showNotif("Falta información del producto "+e,"red-10");if(!this.order.products[e].purchase_price>0)return void this.showNotif(`Especificar el costo de ${this.productNameModel[e]}s`,"red-10");if(!this.order.products[e].purchase_quantity>0)return void this.showNotif(`Especificar cantidad de ${this.productNameModel[e]}s`,"red-10")}this.updateSupplyOrder()}else this.showNotif("Proveer monto total","red-10");else this.showNotif("Seleccionar tipo de moneda","red-10");else this.showNotif("Ingresar número de factura","red-10");else this.showNotif("Ingresar fecha de compra","red-10");else this.showNotif("Ingresar nombre de proveedor","red-10")},updateSupplyOrder(){if(this.loading1||this.loading2)return;console.log("JSON.stringify(this.order): \n"+JSON.stringify(this.order)),this.loading1=!0;n["a"].updateSupplyOrder(this.order,this.supplyOrderId).subscribe({complete:()=>{this.loading=!1,this.showNotif("Compra creada exitosamente","indigo-10"),setTimeout(this.$router.back(),1e3)}})},confirmDelete(){this.$q.dialog({title:"Confirmar",message:"¿Está seguro de querer eliminar esta orden de compra?",cancel:!0,persistent:!0,color:"red-10"}).onOk(()=>{this.deleteSupplyOrder()}).onCancel(()=>{})},deleteSupplyOrder(){this.loading2=!0;n["a"].deleteSupplyOrder(this.supplyOrderId).subscribe({complete:()=>{this.loading2=!1,console.log("[supplier Deleted]"),this.showNotif("Usuario Eliminado","indigo-10"),setTimeout(()=>this.backToUsers(),1e3)}})},backToSupplyOrders(){this.$router.back()},isGreaterThanZero(e){return NaN!=parseNumber(e)&&parseNumber(e)>0?!!e:"Número debe ser mayor que cero"},showNotif(e,t){this.$q.notify({message:e,color:t,actions:[{label:"Dismiss",color:"white",handler:()=>{}}]})},filterFn(e,t){t(()=>{""!==e?(this.supplierHint="Esperando a que termine de escribir",this.supplierQuery=e,this.debouncedGetSupplier()):this.supplierHint="Ingrese el correo del suppliere"})},getSuppliers(){this.searchingSupplier=!0,this.supplierHint="Solicitando...",l["a"].searchSuppliers(this.supplierQuery).subscribe({next:e=>{if(console.log(e),this.supplierOptions.splice(0,this.supplierOptions.length),this.supplierIndex.splice(0,this.supplierIndex.length),e.length>0){for(let t=0;t<e.length;t++)this.supplierOptions.push(e[t].name),this.supplierIndex.push(e[t].id),this.supplierHint="Recibido";this.options=this.supplierOptions}else this.supplierHint="No se encontraron resultados"},complete:()=>{this.searchingSupplier=!1}})},setSupplier(){this.order.purchase.provider=this.supplierOptions.indexOf(this.supplierNameModel)>=0?this.supplierIndex[this.supplierOptions.indexOf(this.supplierNameModel)]:null},filterFn2(e,t){t(()=>{""!==e&&(this.productQuery=e,this.debouncedGetProducts())})},getProducts(){d["a"].searchProducts(this.productQuery).subscribe({next:e=>{if(console.log(e.results),console.log(e.results.length),this.productOptions.splice(0,this.productOptions.length),this.productIndex.splice(0,this.productIndex.length),e.results.length>0){for(let t=0;t<e.results.length;t++)this.productOptions.push(e.results[t].name),this.productIndex.push(e.results[t].id),this.productPrices.push(e.results[t].price);this.options2=this.productOptions,console.log(this.productOptions)}},complete:()=>{console.log("[complete]")}})},isGreaterThanZero(e){return e>0?!!e:"Ingresar cantidad comprada"}},created:function(){this.debouncedGetSupplier=i.a.debounce(this.getSuppliers,500),this.debouncedGetProducts=i.a.debounce(this.getProducts,500)}}),h=p,m=r("2877"),f=r("9989"),g=r("9c40"),b=r("27f9"),v=r("05c0"),x=r("ddd8"),y=r("66e5"),q=r("4074"),O=r("eb85"),S=r("eebe"),k=r.n(S),C=Object(m["a"])(h,s,o,!1,null,null,null);t["default"]=C.exports;k()(C,"components",{QPage:f["a"],QBtn:g["a"],QInput:b["a"],QTooltip:v["a"],QSelect:x["a"],QItem:y["a"],QItemSection:q["a"],QSeparator:O["a"]})}}]);