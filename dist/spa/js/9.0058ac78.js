(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{"2d0f":function(t,e,o){"use strict";(function(t){var a=o("e9b9"),i=o("bc3a"),r=o.n(i);o("cc2c");const s=t.env.API_URL+"panel/";class n{getPromotions(t,e){return a["a"].create(o=>{r.a.get(s+`promotions/list?limit=${t}&offset=${e}`).then(t=>{o.next(t.data),o.complete()}).catch(t=>{o.error(t)})})}createPromotion(t,e){return a["a"].create(o=>{r.a.post(s+"promotions/",{promotion:t,Detail:e}).then(t=>{console.log(t),o.next(t.data),o.complete()}).catch(t=>{o.error(t)})})}getPromotion(t){return a["a"].create(e=>{console.log("id: "+t),r.a.get(s+`promotions/search/${t}/`).then(t=>{e.next(t.data),e.complete()}).catch(t=>{e.error(t)})})}updatePromotion(t,e,o,i){return a["a"].create(a=>{r.a.put(s+`promotions/search/${i}/`,{promotion:t,Detail:e,newDetail:o}).then(t=>{console.log(),a.next(t.data),a.complete()}).catch(t=>{a.error(t)})})}deletePromotion(t){return a["a"].create(e=>{r.a.delete(s+`promotions/search/${t}/`).then(t=>{console.log(),e.next(t.data),e.complete()}).catch(t=>{e.error(t)})})}}e["a"]=new n}).call(this,o("4362"))},"560a":function(t,e,o){"use strict";(function(t){var a=o("e9b9"),i=o("bc3a"),r=o.n(i);const s=t.env.API_URL+"panel/";class n{getProducts(t,e){return a["a"].create(o=>{r.a.get(s+`products/?limit=${t}&offset=${e}`).then(t=>{o.next(t.data),o.complete()}).catch(t=>{o.error(t)})})}getAllProducts(){return a["a"].create(t=>{r.a.get(s+"products/").then(e=>{console.log(e.data),t.next(e.data),t.complete()}).catch(e=>{t.error(e)})})}searchProducts(t){return a["a"].create(e=>{r.a.get(s+`products/coincidence/${t}/`).then(t=>{e.next(t.data),e.complete()}).catch(t=>{e.error(t)})})}createProduct(t,e,o){return a["a"].create(a=>{r()({method:"post",url:s+"products/",data:t,headers:{"Content-Type":"multipart/form-data"}}).then(t=>{let i=t.data.id;0===Object.keys(e).length&&(a.next(t.data),a.complete()),r()({method:"post",url:s+"products/features/",data:{features:e,product:t.data.id}}).then(t=>{0===Object.keys(o).length&&(a.next(t.data),a.complete()),o.append("product",i),r()({method:"post",url:s+"products/gallery/",data:o,headers:{"Content-Type":"multipart/form-data"}}).then(t=>{a.next(t.data),a.complete()}).catch(t=>{console.log(t),a.error(t)})}).catch(t=>{console.log(t)})}).catch(t=>{console.log(t)})})}getProduct(t){return a["a"].create(e=>{console.log("id: "+t),r.a.get(s+`products/search/${t}/`).then(t=>{e.next(t.data),e.complete()}).catch(t=>{e.error(t)})})}updateProduct(t,e){return a["a"].create(o=>{r.a.put(s+`products/search/${e}/`,t).then(t=>{console.log(),o.next(t.data),o.complete()}).catch(t=>{o.error(t)})})}deleteProduct(t){return a["a"].create(e=>{r.a.delete(s+`products/search/${t}/`).then(t=>{console.log("Siiiiii"),e.next(t.data),e.complete()}).catch(t=>{console.log(t.response.data),e.error(t)})})}getDetailProduct(t){return a["a"].create(e=>{r.a.get(s+`products/product-detail/${t}/`).then(t=>{console.log(),e.next(t.data),e.complete()}).catch(t=>{e.error(t)})})}deleteDetailProduct(t){return a["a"].create(e=>{r.a.delete(s+`products/product-detail/${t}/`).then(t=>{console.log(),e.next(t.data),e.complete()}).catch(t=>{e.error(t)})})}}e["a"]=new n}).call(this,o("4362"))},cc2c:function(t,e,o){"use strict"},d449:function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("q-page",[o("div",{staticClass:"col-md-12 col-xs-12 q-pa-sm"},[o("div",{staticClass:"q-pa-sm"},[o("div",{staticClass:"row"},[o("div",{staticClass:"col"},[o("div",{staticClass:"row"},[o("div",{staticClass:"col",staticStyle:{"max-width":"40px"}},[o("q-btn",{staticStyle:{color:"#9E9E9E"},attrs:{flat:"",round:"",icon:"keyboard_backspace"},on:{click:function(e){return t.$router.back()}}})],1),o("div",{staticClass:"col2"},[o("h5",{staticClass:"vertical-top col2 text-indigo-10 text-weight-bolder q-pa-sm",staticStyle:{"margin-top":"-3px"}},[t._v("\n                        Editar Promoción\n                    ")])])])]),t.fetched?o("div",{staticClass:"column items-end"},[o("div",{staticClass:"col"},[o("div",{staticClass:"row"},[o("q-btn",{staticClass:"q-pa-xs q-mr-xs float-right",attrs:{flat:"",color:"red-10",label:"Eliminar"},on:{click:function(e){return t.confirmDelete()}}}),o("q-btn",{staticClass:"q-pa-xs float-right",attrs:{color:"red-10",label:"Guardar"},on:{click:function(e){return t.updatePromotion()}}})],1)])]):t._e()]),o("div",{staticClass:"q-mx-xs"},[o("q-form",{ref:"myForm"},[o("div",{staticClass:"row q-mb-md"},[o("div",{staticClass:"col"},[o("div",{staticClass:"row"},[o("div",{staticClass:"col"},[o("q-input",{attrs:{outlined:"",label:"Nombre","lazy-rules":"",color:"dark",rules:[function(t){return!!t||"Debe ingresar el nombre"}]},model:{value:t.promotion.name,callback:function(e){t.$set(t.promotion,"name",e)},expression:"promotion.name"}})],1)])])]),o("div",{staticClass:"row q-mb-md"},[o("div",{staticClass:"col"},[o("q-input",{attrs:{outlined:"",autogrow:"",color:"dark",label:"Descripción"},model:{value:t.promotion.description,callback:function(e){t.$set(t.promotion,"description",e)},expression:"promotion.description"}})],1)]),o("div",{staticClass:"row q-mb-md"},[o("div",{staticClass:"col"},[o("div",{staticClass:"row"},[o("div",{staticClass:"col"},[o("q-select",{attrs:{outlined:"",color:"dark",options:t.currencyOptions,label:"Moneda"},model:{value:t.promotion.coin,callback:function(e){t.$set(t.promotion,"coin",e)},expression:"promotion.coin"}})],1),o("div",{staticClass:"col q-ml-sm"},[o("q-input",{attrs:{outlined:"",label:"Costo total",mask:"#.##","fill-mask":"0",color:"dark",prefix:t.promotion.coin,"reverse-fill-mask":"","input-class":"text-right"},model:{value:t.promotion.price,callback:function(e){t.$set(t.promotion,"price",t._n(e))},expression:"promotion.price"}})],1)])])]),o("div",{staticClass:"row q-mb-md"},[o("div",{staticClass:"col"},[o("q-select",{attrs:{outlined:"","use-input":"","hide-selected":"","fill-input":"",color:"dark","input-debounce":"0",label:"Categoría",options:t.options},on:{filter:t.filterFn},scopedSlots:t._u([{key:"no-option",fn:function(){return[o("q-item",[o("q-item-section",{staticClass:"text-grey"},[t._v("\n                            No results\n                          ")])],1)]},proxy:!0}]),model:{value:t.categoryNameModel,callback:function(e){t.categoryNameModel=e},expression:"categoryNameModel"}})],1),o("div",{staticClass:"col-2 q-ml-sm"},[o("q-input",{attrs:{type:"number",label:"Existencias",outlined:"",color:"dark"},model:{value:t.promotion.quantity,callback:function(e){t.$set(t.promotion,"quantity",t._n(e))},expression:"promotion.quantity"}})],1)])]),o("q-separator",{attrs:{inset:""}}),o("h5",{staticClass:"vertical-top col2 text-indigo-10 text-weight-bolder q-pa-md"},[t._v("\n                  Detalle de Productos\n              ")]),t.savedProductDetail.length>0?o("div",[o("h6",{staticClass:"vertical-top col2 text-indigo-10 text-weight-bolder q-pa-md"},[t._v("\n                    Productos Guardados\n                ")]),o("div",{staticClass:"q-gutter-md"},t._l(this.savedProductDetail,(function(e,a){return o("div",[o("div",{staticClass:"row q-my-md"},[o("div",{staticClass:"col"},[o("div",{staticClass:"row"},[o("div",{staticClass:"col-8"},[o("q-input",{attrs:{outlined:"",disable:"","hide-selected":"","fill-input":"",color:"dark","input-debounce":"0",label:"Producto"},model:{value:t.savedproductNameModel[a],callback:function(e){t.$set(t.savedproductNameModel,a,e)},expression:"savedproductNameModel[index]"}})],1),o("div",{staticClass:"col-2 q-mx-auto"},[o("q-input",{attrs:{type:"number",label:"Cantidad",color:"dark",outlined:""},model:{value:t.savedProductDetail[a].quantity,callback:function(e){t.$set(t.savedProductDetail[a],"quantity",t._n(e))},expression:"savedProductDetail[index].quantity"}})],1),o("div",{staticClass:"col-1 self-center"},[o("div",{staticClass:"row"},[o("q-btn",{attrs:{flat:"",round:"",color:"indigo-10",icon:"delete"},on:{click:function(e){return t.removeProduct(a)}}})],1)])])])])])})),0),o("q-separator",{attrs:{inset:""}}),o("h6",{staticClass:"vertical-top col2 text-indigo-10 text-weight-bolder q-pa-md"},[t._v("\n                    Productos Nuevos\n                ")])],1):t._e(),o("div",{staticClass:"q-gutter-md"},t._l(this.detail,(function(e,a){return o("div",[o("div",{staticClass:"row q-my-md"},[o("div",{staticClass:"col"},[o("div",{staticClass:"row"},[o("div",{staticClass:"col-8"},[o("q-select",{attrs:{outlined:"","use-input":"","hide-selected":"","fill-input":"",color:"dark","input-debounce":"0",label:"Producto",options:t.options2},on:{filter:t.filterFn2},scopedSlots:t._u([{key:"no-option",fn:function(){return[o("q-item",[o("q-item-section",{staticClass:"text-grey"},[t._v("\n                                  No results\n                                ")])],1)]},proxy:!0}],null,!0),model:{value:t.productNameModel[a],callback:function(e){t.$set(t.productNameModel,a,e)},expression:"productNameModel[index]"}})],1),o("div",{staticClass:"col-2 q-mx-auto"},[o("q-input",{attrs:{type:"number",label:"Cantidad",color:"dark",outlined:""},model:{value:t.detail[a].quantity,callback:function(e){t.$set(t.detail[a],"quantity",t._n(e))},expression:"detail[index].quantity"}})],1),o("div",{staticClass:"col-1 self-center"},[o("div",{staticClass:"row"},[o("q-btn",{attrs:{flat:"",round:"",color:"indigo-10",icon:"delete"},on:{click:function(e){return t.removeProduct(a)}}})],1)])])])])])})),0),o("q-btn",{attrs:{flat:"",round:"",color:"indigo-10",icon:"add"},on:{click:function(e){return t.addProduct()}}})],1)])])])},i=[],r=(o("e01a"),o("c975"),o("a434"),o("2ef0")),s=o.n(r),n=o("2b0e"),c=o("2d0f"),l=o("fab5"),d=o("560a"),u=o("f508"),p=n["default"].extend({data(){return{promotionId:this.$router.currentRoute.params.id,promotion:{name:"",description:"",image:null,price:0,coin:"",quantity:0,category:0},detail:[{quantity:0,product:0}],loading1:!1,loading2:!1,fetched:!1,categoryOptions:[],categoryIndex:[],options:[],productIndex:[],productOptions:[{id:0,name:"",price:0}],options2:[],currencyOptions:["USD","BS"],statusOptions:["COMPLETE"],categoryNameModel:"",savedproductNameModel:[],savedProductDetail:[{id:0,quantity:0,product:0}],productNameModel:[]}},mounted(){let t=this;t.onRequest()},methods:{onRequest(){this.detail.pop(),this.productOptions.pop(),this.savedProductDetail.pop(),u["a"].show(),l["a"].getAllCategories().subscribe({next:t=>{for(let e=0;e<t.length;e++)this.categoryOptions.push(t[e].name),this.categoryIndex.push(t[e].id)},complete:()=>{console.log("[complete]\ncategoryOptions: "+this.categoryOptions+"\ncategoryIndex: "+this.categoryIndex)}}),c["a"].getPromotion(this.promotionId).subscribe({next:t=>{console.log(t),this.promotion.name=t.name,this.promotion.description=t.description,this.promotion.image=t.image,this.promotion.price=t.price,this.promotion.coin=t.coin,this.promotion.quantity=t.quantity,this.promotion.category=t.category.id,this.categoryNameModel=t.category.name,this.savedProductDetail.splice(0,1),console.log(this.savedProductDetail);for(let e=0;e<t.promotion_detail.length;e++)this.savedProductDetail.push({id:t.promotion_detail[e].id,product:t.promotion_detail[e].product.id,quantity:t.promotion_detail[e].quantity}),this.savedproductNameModel.push(t.promotion_detail[e].product.name),console.log(this.savedProductDetail)},complete:()=>{this.fetched=!0,u["a"].hide()}})},addProduct(){this.detail.push({quantity:0,product:0}),this.productNameModel.push(""),console.log("this.productNameModel.length: "+this.productNameModel.length)},getProductInfo(t,e){console.log("user input: "+t+"\nposition: "+this.productOptions.indexOf(t)),this.productOptions.indexOf(t)>=0&&(this.detail[e].product=this.productIndex[this.productOptions.indexOf(t)]),console.log(this.detail)},removeSavedProduct(t){this.savedProductDetail.splice(t,1),this.savedproductNameModel.splice(t,1)},removeProduct(t){this.detail.length>1&&(this.detail.splice(t,1),this.productNameModel.splice(t,1))},updatePromotion(){if(""!==this.promotion.name)if(""!==this.promotion.coin)if(!this.promotion.price>0)this.showNotif("Añadir el precio de la promo","red-10");else if(this.categoryOptions.indexOf(this.categoryNameModel)>=0){for(var t=0;t<this.detail.length;t++){if(""===this.productNameModel[t])return void this.showNotif("Seleccionar nombre del producto "+t,"red-10");if(!this.detail[t].quantity>0)return void this.showNotif(`Especificar cantidad de ${this.productNameModel[t]}s`,"red-10")}this.promotion.category=this.categoryIndex[this.categoryOptions.indexOf(this.categoryNameModel)],this.loading=!0,c["a"].updatePromotion(this.promotion,this.savedProductDetail,this.detail,this.promotionId).subscribe({complete:()=>{this.loading=!1,this.showNotif("Promoción creada exitosamente","indigo-10"),setTimeout(this.$router.back(),1e3)}})}else this.showNotif("Agregar categoría de la promo","red-10");else this.showNotif("Especificar el tipo de moneda","red-10");else this.showNotif("Proveer nombre de promoción","red-10")},confirmDelete(){this.loading1||this.loading2||this.$q.dialog({title:"Confirmar",message:"¿Está seguro de querer eliminar esta promoción?",cancel:!0,persistent:!0,color:"red-10"}).onOk(()=>{this.deletePromotion()}).onCancel(()=>{})},deletePromotion(){this.loading2=!0,c["a"].deletePromotion(this.promotionId).subscribe({next:()=>{this.loading2=!1,console.log("[user Deleted]"),this.showNotif("Promoción Eliminada exitosamente","indigo-10"),setTimeout(()=>this.$router.push({path:"/Promotions"}),1e3)}})},backToPromotions(){this.$router.back()},showNotif(t,e){this.$q.notify({message:t,color:e,actions:[{label:"Dismiss",color:"white",handler:()=>{}}]})},filterFn(t,e){e(()=>{if(""===t)this.options=this.categoryOptions;else{const e=t.toLowerCase();this.options=this.categoryOptions.filter(t=>t.toLowerCase().indexOf(e)>-1),console.log("val: "+t)}})},filterFn2(t,e){e(()=>{""!==t&&(this.productQuery=t,this.debouncedGetProducts())})},getProducts(){d["a"].searchProducts(this.productQuery).subscribe({next:t=>{if(console.log(t.results),console.log(t.results.length),this.productOptions.splice(0,this.productOptions.length),this.productIndex.splice(0,this.productIndex.length),t.results.length>0){for(let e=0;e<t.results.length;e++)this.productOptions.push(t.results[e].name),this.productIndex.push(t.results[e].id);this.options2=this.productOptions,console.log(this.productOptions)}},complete:()=>{console.log("[complete]")}})},isGreaterThanZero(t){return t>0?!!t:"Ingresar cantidad comprada"},backToPromotions(){this.$router.push({path:"promotions/"})}},created:function(){this.debouncedGetProducts=s.a.debounce(this.getProducts,500)}}),m=p,h=o("2877"),g=o("9989"),f=o("9c40"),v=o("0378"),x=o("27f9"),b=o("7d53"),y=o("0016"),q=o("ddd8"),C=o("66e5"),P=o("4074"),w=o("eb85"),k=o("eebe"),$=o.n(k),N=Object(h["a"])(m,a,i,!1,null,null,null);e["default"]=N.exports;$()(N,"components",{QPage:g["a"],QBtn:f["a"],QForm:v["a"],QInput:x["a"],QFile:b["a"],QIcon:y["a"],QSelect:q["a"],QItem:C["a"],QItemSection:P["a"],QSeparator:w["a"]})},fab5:function(t,e,o){"use strict";(function(t){var a=o("e9b9"),i=o("bc3a"),r=o.n(i);const s=t.env.API_URL+"panel/";class n{getCategories(t,e){return a["a"].create(o=>{r.a.get(s+`categories/?limit=${t}&offset=${e}`).then(t=>{o.next(t.data),o.complete()}).catch(t=>{o.error(t)})})}getAllCategories(){return a["a"].create(t=>{r.a.get(s+"categories/list-all").then(e=>{t.next(e.data),t.complete()}).catch(e=>{t.error(e)})})}createCategory(t){return a["a"].create(e=>{console.log(t),r.a.post(s+"categories/save/",t,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{console.log(t),e.next(t.data),e.complete()}).catch(t=>{e.error(t)})})}getCategory(t){return a["a"].create(e=>{console.log("id: "+t),r.a.get(s+`categories/${t}/`).then(t=>{e.next(t.data),e.complete()}).catch(t=>{e.error(t)})})}updateCategory(t,e){return a["a"].create(o=>{r.a.put(s+`categories/${t}/`,e,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{console.log(),o.next(t.data),o.complete()}).catch(t=>{o.error(t)})})}deleteCategory(t){return a["a"].create(e=>{r.a.delete(s+`categories/${t}/`).then(t=>{console.log("Entreee"),e.next(t.data),e.complete()}).catch(t=>{console.log("nooo Entreee",t),e.error(t)})})}}e["a"]=new n}).call(this,o("4362"))}}]);