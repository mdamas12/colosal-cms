(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{"289f":function(t,e,a){"use strict";var s=a("e9b9"),o=a("bc3a"),i=a.n(o);const n='"http://minimarketcolosal.com/api/"panel/';class l{getPayments(){return s["a"].create(t=>{i.a.get(n+"payments/").then(e=>{t.next(e.data),t.complete()}).catch(e=>{t.error(e)})})}createPayment(t){return s["a"].create(e=>{i.a.post(n+"payments/",{bank:t.bank,method:t.method}).then(t=>{console.log(t),e.next(t.data),e.complete()}).catch(t=>{e.error(t)})})}}e["a"]=new l},5052:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",[a("div",{staticClass:"col-md-12 col-xs-12 q-pa-sm"},[a("div",{staticClass:"q-ma-sm"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col",staticStyle:{"max-width":"40px"}},[a("q-btn",{staticStyle:{color:"#9E9E9E"},attrs:{flat:"",round:"",icon:"keyboard_backspace"},on:{click:function(e){return t.$router.back()}}})],1),a("div",{staticClass:"col2"},[a("h5",{staticClass:"vertical-top col2 text-indigo-10 text-weight-bolder q-pa-sm",staticStyle:{"margin-top":"-3px"}},[t._v("\n                    Nueva Venta\n                ")])])]),a("div",{staticClass:"row"},[a("h6",{staticClass:"vertical-top col2 text-indigo-10 text-weight-bolder q-pa-sm",staticStyle:{"margin-top":"-3px"}},[t._v("\n                  Información de Compra\n              ")])])]),a("div",{staticClass:"column items-end"},[a("div",{staticClass:"col"},[a("div",{staticClass:"row"},[a("q-btn",{staticClass:"q-pa-xs float-right",attrs:{color:"red-10",loading:t.loading,label:"Crear compra"},on:{click:function(e){return t.createSale()}},scopedSlots:t._u([{key:"loading",fn:function(){return[a("q-spinner-facebook")]},proxy:!0}])})],1)])])]),a("div",{staticClass:"q-ma-sm"},[a("div",{staticClass:"row q-ma-bg"},[a("div",{staticClass:"col"},[a("q-select",{attrs:{outlined:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",label:"Cliente","stack-label":"",loading:t.searchingClient,hint:t.clientHint,options:t.options},on:{filter:t.filterFn,input:function(e){return t.setClient()}},scopedSlots:t._u([{key:"control",fn:function(){return[a("div",{staticClass:"self-center full-width no-outline",attrs:{tabindex:"0"}})]},proxy:!0}]),model:{value:t.clientNameModel,callback:function(e){t.clientNameModel=e},expression:"clientNameModel"}})],1),a("div",{staticClass:"col q-mx-sm"},[a("q-input",{attrs:{outlined:"",autogrow:"",label:"Descripción"},model:{value:t.sale.description,callback:function(e){t.$set(t.sale,"description",e)},expression:"sale.description"}})],1)]),a("br"),a("q-separator",{staticClass:"q-my-md",attrs:{inset:""}}),a("div",{staticClass:"row q-ma-bg"},[a("div",{staticClass:"col2"},[a("h6",{staticClass:"vertical-top col2 text-indigo-10 text-weight-bolder q-pa-sm",staticStyle:{"margin-top":"-3px"}},[t._v("\n                  Información de Pago\n              ")])])]),a("div",{staticClass:"row q-ma-bg"},[a("div",{staticClass:"col"},[a("q-select",{attrs:{outlined:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",label:"Banco","stack-label":"",options:t.options3},on:{filter:t.filterFn3},scopedSlots:t._u([{key:"control",fn:function(){return[a("div",{staticClass:"self-center full-width no-outline",attrs:{tabindex:"0"}})]},proxy:!0}]),model:{value:t.bankNameModel,callback:function(e){t.bankNameModel=e},expression:"bankNameModel"}})],1),a("div",{staticClass:"col q-mx-sm"},[a("q-select",{attrs:{outlined:"",options:t.currencyOptions,label:"Moneda","stack-label":""},scopedSlots:t._u([{key:"prepend",fn:function(){return[a("q-icon",{attrs:{name:"money"}})]},proxy:!0}]),model:{value:t.sale.coin,callback:function(e){t.$set(t.sale,"coin",e)},expression:"sale.coin"}})],1),a("div",{staticClass:"col"},[a("q-select",{attrs:{outlined:"",options:t.paymentOptions,label:"Forma de Pago","stack-label":""},model:{value:t.sale.payment_type,callback:function(e){t.$set(t.sale,"payment_type",e)},expression:"sale.payment_type"}})],1)]),a("br"),a("q-separator",{staticClass:"q-my-md",attrs:{inset:""}}),a("div",{staticClass:"row q-ma-bg"},[a("div",{staticClass:"col2"},[a("h6",{staticClass:"vertical-top col2 text-indigo-10 text-weight-bolder q-pa-sm",staticStyle:{"margin-top":"-3px"}},[t._v("\n                  Productos Adquiridos\n              ")])])]),a("div",{staticClass:"row q-mx-md"},[a("div",{staticClass:"col"},[t._l(this.sale_detail,(function(e,s){return a("div",[a("div",{staticClass:"row q-mb-md"},[a("div",{staticClass:"col-8"},[a("q-select",{attrs:{outlined:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",label:"Producto",options:t.options2,rules:[function(t){return!!t||"Debe seleccionar algún producto"}]},on:{filter:t.filterFn2,input:function(e){return t.getProductInfo(t.productNameModel[s],s)}},scopedSlots:t._u([{key:"no-option",fn:function(){return[a("q-item",[a("q-item-section",{staticClass:"text-grey"},[t._v("\n                            No results\n                          ")])],1)]},proxy:!0}],null,!0),model:{value:t.productNameModel[s],callback:function(e){t.$set(t.productNameModel,s,e)},expression:"productNameModel[index]"}})],1),a("div",{staticClass:"col-2 q-mx-auto"},[a("q-input",{attrs:{type:"number",label:"Cantidad",outlined:"","lazy-rules":"",rules:[function(t){return!!t||"Ingresar cantidad comprada"},t.isGreaterThanZero]},model:{value:t.sale_detail[s].quantity,callback:function(e){t.$set(t.sale_detail[s],"quantity",t._n(e))},expression:"sale_detail[index].quantity"}})],1),a("div",{staticClass:"col-1 self-center"},[a("div",{staticClass:"row"},[a("q-btn",{attrs:{flat:"",round:"",color:"indigo-10",icon:"delete"},on:{click:function(e){return t.removeProduct(s)}}})],1)])])])})),a("q-btn",{attrs:{flat:"",round:"",color:"indigo-10",icon:"add"},on:{click:function(e){return t.addProduct()}}})],2)])],1)])])])},o=[],i=(a("c975"),a("a434"),a("2ef0")),n=a.n(i),l=a("2b0e"),c=a("6a55"),r=a("560a"),d=a("289f"),u=a("f508"),p=l["default"].extend({data(){return{paymentOptions:["ZELLE","TRANSFERENCIA BS","PAGO MOVIL","EFECTIVO"],currencyOptions:["USD","BS"],clientHint:"",clientQuery:"",productQuery:"",searchingClient:!1,loading:!1,sale:{description:"",customer:0,bank:0,payment_type:"",coin:""},sale_detail:[{product:0,quantity:0,price:0}],clientOptions:[{id:0,name:""}],bankOptions:[{id:0,name:""}],productOptions:[{id:0,name:"",price:0}],currentProductIndex:0,clientIndex:[],options:[],productIndex:[],productPrices:[],options2:[],clientNameModel:"",productNameModel:[],bankIndex:[],options3:[],bankNameModel:""}},mounted(){let t=this;t.onRequest()},methods:{onRequest(){u["a"].show(),this.productOptions.pop();d["a"].getPayments().subscribe({next:t=>{this.bankOptions.pop();for(let e=0;e<t.length;e++)this.bankOptions.push(t[e].name),this.bankIndex.push(t[e].id)},complete:()=>{console.log("[complete]"),u["a"].hide()}})},addProduct(){this.sale_detail.push({product:0,price:0,quantity:0}),this.productNameModel.push("")},getProductInfo(t,e){console.log("user input: "+t+"\nposition: "+this.productOptions.indexOf(t)),this.productOptions.indexOf(t)>=0&&(this.sale_detail[e].product=this.productIndex[this.productOptions.indexOf(t)],this.sale_detail[e].price=parseFloat(this.productPrices[this.productOptions.indexOf(t)])),console.log(this.sale_detail)},removeProduct(t){this.sale_detail.length>1&&(this.sale_detail.splice(t,1),this.productNameModel.splice(t,1))},createSale(){if(""===this.clientNameModel)return void this.showNotif("Proveer correo de cliente","red-10");if(""===this.sale.coin||""===this.sale.payment_type)return void this.showNotif("Completar información de pago","red-10");if(0==this.sale_detail.length)return void this.showNotif("Debe agregar al menos un producto","red-10");for(var t=0;t<this.sale_detail.length;t++){if(""===this.productNameModel[t])return void this.showNotif("Falta información del producto "+t,"red-10");if(this.sale_detail[t].quantity<=0)return void this.showNotif(`Especificar cantidad de ${this.productNameModel[t]}s`,"red-10")}if(""===this.bankNameModel)return void this.showNotif("Proveer nombre de banco","red-10");this.sale.bank=this.bankOptions.indexOf(this.bankNameModel)>=0?this.bankIndex[this.bankOptions.indexOf(this.bankNameModel)]:null,console.log("everything in order. Creating sale..."),this.loading=!0;c["a"].createSale({sale:this.sale,sale_detail:this.sale_detail}).subscribe({complete:()=>{this.loading=!1,this.showNotif("Venta creada exitosamente","indigo-10"),setTimeout(this.$router.back(),1e3)}})},showNotif(t,e){this.$q.notify({message:t,color:e,actions:[{label:"Dismiss",color:"white",handler:()=>{}}]})},filterFn(t,e){e(()=>{""!==t?(this.clientHint="Esperando a que termine de escribir",this.clientQuery=t,this.debouncedGetClient()):this.clientHint="Ingrese el correo del cliente"})},getClients(){this.searchingClient=!0,this.clientHint="Solicitando...",c["a"].searchUsers(this.clientQuery).subscribe({next:t=>{if(console.log(t),this.clientOptions.splice(0,this.clientOptions.length),this.clientIndex.splice(0,this.clientIndex.length),t.length>0){for(let e=0;e<t.length;e++)this.clientOptions.push(t[e].email),this.clientIndex.push(t[e].id),this.clientHint="Recibido";this.options=this.clientOptions}else this.clientHint="No se encontraron resultados"},complete:()=>{this.searchingClient=!1}})},setClient(){this.sale.customer=this.clientOptions.indexOf(this.clientNameModel)>=0?this.clientIndex[this.clientOptions.indexOf(this.clientNameModel)]:null},filterFn2(t,e){e(()=>{""!==t&&(this.productQuery=t,this.debouncedGetProducts())})},getProducts(){r["a"].searchProducts(this.productQuery).subscribe({next:t=>{if(console.log(t.results),console.log(t.results.length),this.productOptions.splice(0,this.productOptions.length),this.productIndex.splice(0,this.productIndex.length),t.results.length>0){for(let e=0;e<t.results.length;e++)this.productOptions.push(t.results[e].name),this.productIndex.push(t.results[e].id),this.productPrices.push(t.results[e].price);this.options2=this.productOptions,console.log(this.productOptions)}},complete:()=>{console.log("[complete]")}})},filterFn3(t,e){e(()=>{if(""===t)this.options3=this.bankOptions;else{const e=t.toLowerCase();this.options3=this.bankOptions.filter(t=>t.toLowerCase().indexOf(e)>-1),console.log("val: "+t)}})},isGreaterThanZero(t){return t>0?!!t:"Ingresar cantidad comprada"},backToSales(){this.$router.push({path:"sales/"})}},created:function(){this.debouncedGetClient=n.a.debounce(this.getClients,500),this.debouncedGetProducts=n.a.debounce(this.getProducts,500)}}),h=p,m=a("2877"),g=a("9989"),f=a("9c40"),b=a("e669"),x=a("ddd8"),v=a("27f9"),y=a("eb85"),C=a("0016"),k=a("66e5"),q=a("4074"),O=a("eebe"),w=a.n(O),_=Object(m["a"])(h,s,o,!1,null,null,null);e["default"]=_.exports;w()(_,"components",{QPage:g["a"],QBtn:f["a"],QSpinnerFacebook:b["a"],QSelect:x["a"],QInput:v["a"],QSeparator:y["a"],QIcon:C["a"],QItem:k["a"],QItemSection:q["a"]})},"560a":function(t,e,a){"use strict";var s=a("e9b9"),o=a("bc3a"),i=a.n(o);const n='"http://minimarketcolosal.com/api/"panel/';class l{getProducts(t,e){return s["a"].create(a=>{i.a.get(`products/?limit=${t}&offset=${e}`).then(t=>{a.next(t.data),a.complete()}).catch(t=>{a.error(t)})})}getAllProducts(){return s["a"].create(t=>{i.a.get(n+"products/").then(e=>{console.log(e.data),t.next(e.data),t.complete()}).catch(e=>{t.error(e)})})}searchProducts(t){return s["a"].create(e=>{i.a.get(n+`products/coincidence/${t}/`).then(t=>{e.next(t.data),e.complete()}).catch(t=>{e.error(t)})})}createProduct(t,e,a){return s["a"].create(s=>{i()({method:"post",url:n+"products/",data:t,headers:{"Content-Type":"multipart/form-data"}}).then(t=>{let o=t.data.id;0===Object.keys(e).length&&(s.next(t.data),s.complete()),i()({method:"post",url:n+"products/features/",data:{features:e,product:t.data.id}}).then(t=>{0===Object.keys(a).length&&(s.next(t.data),s.complete()),a.append("product",o),i()({method:"post",url:n+"products/gallery/",data:a,headers:{"Content-Type":"multipart/form-data"}}).then(t=>{s.next(t.data),s.complete()}).catch(t=>{console.log(t),s.error(t)})}).catch(t=>{console.log(t)})}).catch(t=>{console.log(t)})})}getProduct(t){return s["a"].create(e=>{console.log("id: "+t),i.a.get(n+`products/search/${t}/`).then(t=>{e.next(t.data),e.complete()}).catch(t=>{e.error(t)})})}updateProduct(t,e){return s["a"].create(a=>{i.a.put(n+`products/search/${e}/`,t).then(t=>{console.log(),a.next(t.data),a.complete()}).catch(t=>{a.error(t)})})}deleteProduct(t){return s["a"].create(e=>{i.a.delete(n+`products/search/${t}/`).then(t=>{console.log("Siiiiii"),e.next(t.data),e.complete()}).catch(t=>{console.log(t.response.data),e.error(t)})})}getDetailProduct(t){return s["a"].create(e=>{i.a.get(n+`products/product-detail/${t}/`).then(t=>{console.log(),e.next(t.data),e.complete()}).catch(t=>{e.error(t)})})}deleteDetailProduct(t){return s["a"].create(e=>{i.a.delete(n+`products/product-detail/${t}/`).then(t=>{console.log(),e.next(t.data),e.complete()}).catch(t=>{e.error(t)})})}}e["a"]=new l},"6a55":function(t,e,a){"use strict";var s=a("e9b9"),o=a("bc3a"),i=a.n(o);const n='"http://minimarketcolosal.com/api/"panel/';class l{getSales(){return s["a"].create(t=>{i.a.get(n+"sales/").then(e=>{t.next(e.data),t.complete()}).catch(e=>{t.error(e)})})}getSalesByStatus(t){return s["a"].create(e=>{i.a.get(n+`sales/list-status/${t}/`).then(t=>{e.next(t.data),e.complete()}).catch(t=>{e.error(t)})})}createSale(t){return s["a"].create(e=>{i.a.post(n+"sales/sale-panel/",{sale:t.sale,sale_detail:t.sale_detail}).then(t=>{console.log(t),e.complete()}).catch(t=>{e.error(t)})})}searchUsers(t){return s["a"].create(e=>{i.a.get(n+`sales/customer/${t}/`).then(t=>{e.next(t.data),e.complete()}).catch(t=>{e.error(t)})})}getSale(t){return s["a"].create(e=>{console.log("id: "+t),i.a.get(n+`sales/detail/${t}/`).then(t=>{e.next(t.data),e.complete()}).catch(t=>{e.error(t)})})}updateSale(t){return s["a"].create(e=>{i.a.put(n+`sales/detail/${t.id}/`,{sale:t.sale,sale_detail:t.sale_detail}).then(t=>{console.log(),e.complete()}).catch(t=>{e.error(t)})})}updateSaleStatus(t,e){return s["a"].create(a=>{i.a.put(n+`sales/detail/${t}/`,{sale:{status:e}}).then(t=>{console.log(t),a.complete()}).catch(t=>{a.error(t)})})}deleteSale(t){return s["a"].create(e=>{i.a.delete(n+`sales/detail/${t}/`).then(t=>{console.log(),e.complete()}).catch(t=>{e.error(t)})})}}e["a"]=new l}}]);